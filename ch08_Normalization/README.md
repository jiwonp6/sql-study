# ◎ 데이터베이스 설계

## * 정규화 (Normalization)
- 데이터베이스 설계 기법
   - 데이터베이스 중복을 최소화하고 -> (중복 감소)
   - 무결성을 유지하기 위해 -> (삽입, 삭제, 갱신이상 제거)
   - 데이터를 구조화하는 과정 -> (구조 개선)

### 이상현상 (anomaly)
   - 잘못 설계된 테이블에서 데이터 조작(삽입, 삭제, 갱신)을 하게 될 경우
   - 테이블의 일관성이 훼손되고, 무결성이 깨지는 현상

   1. 삽입 이상 (Insertion Anomaly)
      - 튜플(행)을 삽입시 부득이하게 null 값이 입력되거나, 중복 데이터 삽입
   2. 갱신 이상 (Update Anomaly)
      - 튜플(행)을 수정시 데이터베이스 속성의 최신 상태가 반영이 되지 않아 일관성이 깨짐
   3. 삭제 이상 (Deletion Anomaly)
      - 튜플(행)을 삭제 시 항목에 연결된 유용한 데이터까지 연쇄 삭제

### 함수 종속성(Functional Dependency)
- 한 속성의 값이, 다른 속성의 값에 의해 결정될 수 있음
- 어떤 속성 A의 값을 알면 다른 속성 B의 값이 유일하게 정해지는 의존 관계
   - "속성 A는 속성 B를 결정한다"
      - A -> B  (표기)
      - A는 B의 결정자(determine)

- 함수 종속성의 종류
   1. 완전 함수 종속
      - 속성 B(종속자)가 속성 A(결정자)에 함수적으로 종속되어 있고, B의 어떤 부분집합으로도 A를 결정할 수 없을 때
      - A -> B, 또는 {A, B} -> C
   2. 부분 함수 종속
      - 종속자(비기본키)가 결정자(기본키)가 아닌 다른 속성에 종속되거나, 결정자를 구성하는 속성(복합키) 중 일부에만 종속된 경우
      - {A, B} -> C 일때, A -> C 성립 *또는* B -> C가 성립하는 경우
   3. 이행 함수 종속
      - 한 속성이 다른 속성에 간접적으로 종속되어 있는 상황
      - A -> B, B -> C 가 성립할 때 A -> C 이행적 종속
   4. 결정자 함수 종속
      - 함수 종속의 결정자가 후보키가 아닌 경우
      - ({A, B}, C) : A -> B, C -> A가 성립하면 A와 C 모두 결정자 두 속성 모두 후보키가 아니고, 후보키의 일부가 됨
   5. 다중값 종속
      - 한 속성이 다른 속성에 대해 여러 값을 독립적으로 가질 수 있을 경우
   6. 조인 종속
      - 릴레이션을 분해했다가, 다시 결합했을 때 원래의 릴레이션으로 복원 가능한 경우

### 제 1 정규형(1NF : 1st Normal Form)
   - 모든 속성이 `원자값`을 가져야 함
      - 원자값 : 분할이 불가능한 기본 데이터 단위
   - 모든 컬럼은 유일한 이름을 가져야 함
   - 한 컬럼 내의 모든 데이터는 같은 데이터 타입이어야 함
   - 테이블 내 각 행(튜플)은 고유해야 하고, 고유한 식별자(기본키)가 사용됨


### 제 2 정규형(2NF)
   - 릴레이션이 1정규형을 만족해야 함
   - 기본 키가 아닌 속성이 기본키에 완전 함수 종속일 때 제2정규형
   - (부분 함수 종속성을 제거)

### 제 3 정규형(3NF)
   - 릴레이션이 2정규형을 만족해야 함
   - 기본 키가 아닌 속성이 기본키에 비이행적으로 종속할 때 제3정규형
   - A -> B, B -> C , A -> C
   - (이행 함수 종속성을 제거)

### Boyce-Codd 정규형 (BCNF), 보이스 코드 정규형
   - 3 정규형의 특별한 케이스. 3정규형보다 조금 더 엄격함
   - 릴레이션이 3정규형을 만족해야 함
   - 모든 결정자가 후보 키여야 함

### 정규화의 한계
   - 설계 및 구현 복잡성이 증가 : 유지보수 및 실사용이 어려워짐
   - 조회 성능 저하 : 정규화를 통한 테이블 분해에서 정보를 얻기 위해 여러 테이블을 조인해야 함 -> 조인 과정에서 복잡도가 증가되고 성능 저하.

   - 비정규화
      - 정규화의 한계를 극복하기 위해 의도적으로 중복을 허용하거나 테이블 구조를 단순화하는 과정
      - 적절하게 사용하면 성능을 향상시킬 수 있지만, 데이터 무결성 문제가 발생할 수 있음
      - 개발자나 DBA가 비정규화 테이블을 사용하고자 하는 유혹이 있지만, 적절하고 신중하게 잘 결정해야 함(trade-off 존재)

   - 일반적으로 3정규형 또는 BCNF정규형까지 정규화 함
   - 4정규형 : 다치 종속성 제거
   - 5정규형 : 조인 종속성 제거

